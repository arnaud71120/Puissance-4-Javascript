<html>
<head>
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
 <meta http-equiv="Content-Language" content="fr" />
 <style type="text/css">
body {
  background-image: url("background.jpg");
}
</style>
 <title>
 Puissance 4
</title>
</head>
<body style="background-image: url('images/background.jpg')">
<center>
  <h1 style="color:blue;">Jeu du Puissance 4</h1>
  <button type="button" onclick="startGame()">DÃ©marrer la partie</button>
  <h2 style="color:red;" id="victoire"></h2>
</center>
<div id="tableau" style="left: 40%; width: 350px; position: absolute; top: 20%; height: 300px">
</div>
</body>
</html>
<script>
var tab, tabJoueur, victoire;
function startGame(){
  document.getElementById('victoire').innerHTML = "";
  var jeton, joueur;
  victoire = 0
  initJoueur();
   tab = tableauInit();
   tabJoueur = choixJoueurInit();

  initGrille();
}
var jeton, joueur;
function initJoueur(){
  jeton = "jetonjaune.gif";
  joueur = 1;
}

function swapJoueur(){
  if(joueur == 1){
    joueur = 2;
    jeton = "jetonrouge.gif";
  }else{
    joueur = 1;
    jeton = "jetonjaune.gif";
  }
}
function tableauInit(){
var tab = new Array();
  for(var i = 0 ; i < 7 ; i++){
    tab[i] = new Array();
      for (var y = 0 ; y < 6 ; y++){
        tab[i].push(false)
          }
  }
  return tab;
}


function choixJoueurInit(){
var tabJoueur = new Array();
  for(var i = 0 ; i < 7 ; i++){
    tabJoueur[i] = new Array();
      for (var y = 0 ; y < 6 ; y++){
        tabJoueur[i].push(false)
          }
  }
  return tabJoueur;
}



function initGrille(){
  var tr1 = new Array();

    for(var i = 0 ; i < 6 ; i++){
      if (i == 0){
        tr = '<table cellspacing="0" cellpadding="0" width="350"><tbody><tr id="Ligne'+i+'">';
      }else{
       tr = '<tr id="Ligne'+i+'">';
     }
        for (var y = 0 ; y < 7 ; y++){
          tr += '<td id="Colonne'+y+'" onclick="addJetons('+y+');"><img src="images/case.gif"> </td>';
            }
            if(i == 6){
            tr += '</tr></tbody></table>';
          }
          else {
          tr +='</tr>';
          }
            tr1.push(tr);
    }
    document.getElementById("tableau").innerHTML = tr1;
}

function addJetons(value){
  if(victoire == 0){
  for(var i = 5 ; i >= 0 ; i--){
    if (tab[value][i] == false){
      tab[value][i] = true;
      tabJoueur[value][i] = joueur;
      var Ligne = 'Ligne' + i;
      var Parent = document.getElementById(Ligne);

      Parent.childNodes[value].innerHTML = '<img style="position: absolute; z-index: 1;" src="images/'+jeton+'"><img src="images/case.gif"> ';

      testVainqueur();
      swapJoueur();
      break;
    }
    if(i == 0 && tab[value][i] == true ){
      alert('Colonne pleine ! \n Veuillez choissir une autre colonne');
      break;
    }
      }
    }
}

function testVainqueur(){
  var lastJoueur;
  var comptLigne=0;
  // test victoire sur ligne horizontal
  for (var i = 5 ; i >= 0 ; i--){
    var lastJoueur;
    var comptLigne=0;
  for(var y = 6 ; y >= 0 ; y--){
    if(tabJoueur[y][i] != false){
      if(lastJoueur == tabJoueur[y][i] ){
        if(comptLigne >= 0 && comptLigne <= 4){
        comptLigne++;}
        else{
          comptLigne =1
        }
      }else{
        comptLigne = 1;
      }
      lastJoueur = tabJoueur[y][i];
      if(comptLigne == 4){
        victoire = 1;
        document.getElementById('victoire').innerHTML = "Victoire du Joueur " + + tabJoueur[y][i] ;
      }
    }
    }
  }

  // test victoire sur ligne vertical
  for (var i = 6 ; i >= 0 ; i--){

    var lastJoueurVertical;
    var comptColonne=0;
  for(var y = 5 ; y >= 0 ; y--){
    if(tabJoueur[i][y] != false){
      if(lastJoueurVertical == tabJoueur[i][y] ){
        if(comptColonne >= 0 && comptColonne <= 4){
        comptColonne++;}
        else{
          comptColonne =1
        }
      }else{
        comptColonne = 1;
      }
      lastJoueurVertical = tabJoueur[i][y];
      if(comptColonne == 4){
        victoire = 1;
        document.getElementById('victoire').innerHTML = "Victoire du Joueur " + + tabJoueur[y][i] ;
      }
    }
    }
  }


  // test victoire sur ligne diagonale gauche
  for (var i = 5 ; i >= 0 ; i--){

    var lastJoueurDiagGauche;
    var comptColonneDiagGauche=0;
  for(var y = 6 ; y >= 0 ; y--){

    if(tabJoueur[y][i] != false){
      var varI= i;
      var varY = y;
      if( y >= 3 && i >=3 ){
        for (var g= 0; g < 4; g++){

      if(lastJoueurDiagGauche == tabJoueur[varY][varI] ){

        if(comptColonneDiagGauche >= 0 && comptColonneDiagGauche <= 4){
        comptColonneDiagGauche++;}
        else{
          comptColonneDiagGauche =1
      }
      }


      else{
        comptColonneDiagGauche = 1;
      }


      lastJoueurDiagGauche = tabJoueur[varY][varI];
      if(comptColonneDiagGauche == 4){
        victoire = 1;
        document.getElementById('victoire').innerHTML = "Victoire du Joueur " + + tabJoueur[y][i] ;
      }
      varI--;
      varY--;
    }
  }
}


    }
  }



  // test victoire sur ligne diagonale droite
  for (var i = 5 ; i >= 0 ; i--){

    var lastJoueurDiagDroite;
    var comptColonneDiagDroite=0;
  for(var y = 6 ; y >= 0 ; y--){

    if(tabJoueur[y][i] != false){
      var varI= i;
      var varY = y;
      if( y <= 3 && i >=3 ){
        for (var g= 0; g < 4; g++){

      if(lastJoueurDiagDroite == tabJoueur[varY][varI] ){

        if(comptColonneDiagDroite >= 0 && comptColonneDiagDroite <= 4){
        comptColonneDiagDroite++;}
        else{
          comptColonneDiagDroite =1
      }
      }


      else{
        comptColonneDiagDroite = 1;
      }


      lastJoueurDiagDroite = tabJoueur[varY][varI];
      if(comptColonneDiagDroite == 4){
        victoire = 1;
        document.getElementById('victoire').innerHTML = "Victoire du Joueur " + + tabJoueur[y][i] ;
      }
      varI--;
      varY++;
    }
  }
}


    }
  }


}



</script>
